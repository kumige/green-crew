<ion-header>
  <ion-toolbar>
    <ion-title>Login</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content padding>
  <form class="form" *ngIf="!registering">
    <ion-item>
      <ion-label id="userLabel" position="floating">Username</ion-label>
      <ion-input
        type="text"
        [(ngModel)]="user.username"
        name="Username"
        (ionBlur)="blur()"
        required
      ></ion-input>
    </ion-item>
    <ion-item>
      <ion-label position="floating">Password</ion-label>
      <ion-input
        type="password"
        [(ngModel)]="user.password"
        name="Password"
        required
      ></ion-input>
    </ion-item>
    <ion-button ion-button type="submit" (click)="login()">Login</ion-button>
  </form>
  <form class="form" [formGroup]="registerForm" *ngIf="registering">
    <ion-item>
      <ion-label position="floating">Email</ion-label>
      <ion-input
        type="text"
        [(ngModel)]="user.email"
        name="Email"
        formControlName="email"
        autofocus
        required
      ></ion-input>
    </ion-item>
    <div class="validation-errors">
      <div
        class="error-message"
        *ngIf="
          registerForm.controls.email.status === 'INVALID' &&
          (registerForm.controls.email.dirty ||
            registerForm.controls.email.touched)
        "
      >
        Please enter a valid email.
      </div>
    </div>
    <ion-item>
      <ion-label position="floating">Username</ion-label>
      <ion-input
        type="text"
        [(ngModel)]="user.username"
        name="Username"
        (ionBlur)="blur()"
        formControlName="username"
        required
      ></ion-input>
    </ion-item>
    <div class="validation-errors">
      <div
        class="error-message"
        *ngIf="
          registerForm.controls.username.status === 'INVALID' &&
          (registerForm.controls.username.dirty ||
            registerForm.controls.username.touched)
        "
      >
        Username must be at least 3 characters long.
      </div>
      <div id="userLabel"></div>
    </div>
    <ion-item>
      <ion-label position="floating">Full name</ion-label>
      <ion-input
        type="text"
        [(ngModel)]="user.full_name"
        formControlName="full_name"
        name="Full Name"
      ></ion-input>
    </ion-item>
    <ion-item [formGroup]="registerForm">
      <ion-label position="floating">Password</ion-label>
      <ion-input
        type="password"
        (ionBlur)="passwordCheck()"
        [(ngModel)]="user.password"
        name="Password"
        formControlName="password"
        required
      ></ion-input>
    </ion-item>
    <div class="validation-errors">
      <div
        class="error-message"
        *ngIf="
          registerForm.controls.password.status === 'INVALID' &&
          (registerForm.controls.password.dirty ||
            registerForm.controls.password.touched)
        "
      >
        Password must be 5 characters long.
      </div>
    </div>
    <ion-item>
      <ion-label position="floating">Re-type password</ion-label>
      <ion-input
        type="password"
        (ionBlur)="passwordCheck()"
        [(ngModel)]="re_password"
        name="Password"
        formControlName="re_password"
        required
      ></ion-input>
    </ion-item>
    <div class="validation-errors">
      <div
        class="error-message"
        *ngIf="
          !samePassword &&
          (registerForm.controls.re_password.dirty ||
            registerForm.controls.re_password.touched)
        "
      >
        Please re-enter your password.
      </div>
    </div>
    <ion-button ion-button type="submit" (click)="register()">
      Register
    </ion-button>
  </form>
  <ion-button id="register" (click)="switchTemplate()">
    <p *ngIf="!registering">
      New User? Click here to register
    </p>
    <p *ngIf="registering">
      Already have an account? Click here to login
    </p>
  </ion-button>
</ion-content>
